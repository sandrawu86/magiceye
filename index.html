<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Magic Eye - Image Switcher</title>
  <script type="text/javascript"
    src="https://rawgit.com/patriciogonzalezvivo/glslCanvas/master/dist/GlslCanvas.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #101515;
      font-family: Arial, sans-serif;
      overflow: hidden;
    }

    #glslCanvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: block;
    }

    #menu {
      position: fixed;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.8);
      padding: 20px;
      border-radius: 8px;
      z-index: 100;
      min-width: 200px;
      max-width: 320px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    }

    #menu h3 {
      color: #fff;
      margin-bottom: 15px;
      font-size: 16px;
      text-align: center;
    }

    #description {
      color: #f0ad4e;
      font-size: 13px;
      line-height: 1.6;
      margin-bottom: 15px;
      padding: 12px;
      background: rgba(240, 173, 78, 0.1);
      border-left: 3px solid #f0ad4e;
      border-radius: 4px;
    }

    .menu-buttons {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .toggle-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 10px;
    }

    .toggle-button {
      flex: 1;
      padding: 10px 12px;
      background: #6c5ce7;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 13px;
      transition: all 0.3s ease;
    }

    .toggle-button:hover {
      background: #574ac9;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .status-pill {
      padding: 8px 10px;
      border-radius: 999px;
      background: #2a9d8f;
      color: #fff;
      font-size: 12px;
      min-width: 40px;
      text-align: center;
    }

    button {
      padding: 10px 15px;
      background: #2a9d8f;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    button:hover {
      background: #21867a;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    button.active {
      background: #e76f51;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    #imageInfo {
      color: #aaa;
      font-size: 12px;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #444;
      text-align: center;
    }
  </style>
</head>

<body>
  <div id="menu">
    <h3>ğŸ•µğŸ» æ¡ˆç™¼ç¾å ´èº²è²“è²“ ğŸˆ</h3>
    <div id="description">
      æ³¨æ„ï¼ï¼ä½ çš„è²“åœ¨å®¶è£¡æ—è›‹äº†ï¼ï¼<br>
      ä½†æ˜¯ç‹¡çŒ¾çš„ç‰ ï¼Œå·§å¦™åœ°åˆ©ç”¨è‡ªå·±çš„èŠ±è‰²ï¼Œ<br>
      å°‡è‡ªå·±å’Œå®¶è£¡çš„å£ç´™èç‚ºä¸€é«”äº†ï¼ï¼<br>
      åªæœ‰ç•¶ä¸»äººä½¿ç”¨è£¸è¦–3Dèƒ½åŠ›æ™‚ï¼Œ<br>
      æ‰æœ‰è¾¦æ³•æŠ“åˆ°é€™éš»æ—è›‹é¬¼ï¼ï¼ï¼
    </div>
   
    <div class="menu-buttons">
      <button data-image="data/final_gray.png">å ´æ™¯ä¸€</button>
      <button data-image="data/final_leopard.png">å ´æ™¯äºŒ</button>
      <button data-image="data/final_orange_2.png">å ´æ™¯ä¸‰</button>
      <br>
    </div>
    
     <div class="toggle-row">
      <button id="glassesBtn" class="toggle-button" aria-pressed="false">ğŸ•¶ï¸ Magic Glasses</button>
    </div>
    <div id="imageInfo"></div>
  </div>

  <canvas id="glslCanvas" data-fragment-url="shaders/magiceye.frag" width="800" height="600"></canvas>

  <script>
    var canvas = document.getElementById("glslCanvas");
    var sandbox = new GlslCanvas(canvas);
    var currentImage = "data/final_gray.png";
    var currentImageName = "å ´æ™¯ä¸€";
    var glassesOn = false;

    var imageInfoEl = document.getElementById("imageInfo");
    var glassesBtn = document.getElementById("glassesBtn");
    var glassesState = document.getElementById("glassesState");

    const sceneMap = {
      "data/final_gray.png": { base: "data/final_gray.png", got: "data/final_gray_got.png" },
      "data/final_leopard.png": { base: "data/final_leopard.png", got: "data/final_leopard.got.png" },
      "data/final_orange_2.png": { base: "data/final_orange_2.png", got: "data/final_orange_2_got.png" }
    };

    var currentScene = sceneMap[currentImage];

    // è¨­å®šåˆå§‹ç´‹ç†
    sandbox.setUniform("u_resolution", canvas.width, canvas.height);

    function applyTexture() {
      var scene = currentScene || { base: currentImage, got: currentImage };
      var target = glassesOn && scene.got ? scene.got : scene.base;
      sandbox.loadTexture("u_texture", target);
      if (imageInfoEl) {
        imageInfoEl.textContent = 'ç›®å‰: ' + currentImageName + (glassesOn ? 'ï¼ˆMagic Glasses é–‹ï¼‰' : 'ï¼ˆè£¸è¦–ï¼‰');
      }
      if (glassesState) {
        glassesState.textContent = glassesOn ? 'ON' : 'OFF';
      }
      if (glassesBtn) {
        glassesBtn.textContent = glassesOn ? 'ğŸ•¶ï¸ Magic Glasses ON' : 'ğŸ•¶ï¸ Magic Glasses OFF';
        glassesBtn.setAttribute('aria-pressed', glassesOn ? 'true' : 'false');
      }
    }

    // è¨­å®š canvas å¡«æ»¿æ•´å€‹è¦–çª—
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      sandbox.setUniform("u_resolution", canvas.width, canvas.height);
    }

    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    // åˆå§‹åŒ–å ´æ™¯æŒ‰éˆ•èˆ‡é­”æ³•çœ¼é¡æŒ‰éˆ•
    const sceneButtons = document.querySelectorAll('.menu-buttons button');
    if (sceneButtons.length > 0) {
      sceneButtons[0].classList.add('active');
    }

    sceneButtons.forEach((button) => {
      button.addEventListener('click', function() {
        const imagePath = this.getAttribute('data-image');
        const imageName = this.textContent;

        // æ›´æ–°æŒ‰éˆ•æ¨£å¼
        sceneButtons.forEach(btn => btn.classList.remove('active'));
        this.classList.add('active');

        // æ›´æ–°å ´æ™¯è³‡è¨Š
        currentImage = imagePath;
        currentImageName = imageName;
        currentScene = sceneMap[imagePath] || { base: imagePath, got: imagePath };

        // ä¾æ“šç•¶å‰çœ¼é¡ç‹€æ…‹å¥—ç”¨è²¼åœ–
        applyTexture();
      });
    });

    if (glassesBtn) {
      glassesBtn.addEventListener('click', function() {
        glassesOn = !glassesOn;
        applyTexture();
      });
    }

    // é¦–æ¬¡è¼‰å…¥è²¼åœ–
    applyTexture();
  </script>

</body>

</html>
