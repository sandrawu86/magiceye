<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Magic Eye - Image Switcher</title>
  <script type="text/javascript"
    src="https://rawgit.com/patriciogonzalezvivo/glslCanvas/master/dist/GlslCanvas.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #101515;
      font-family: Arial, sans-serif;
      overflow: hidden;
    }

    #glslCanvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: block;
    }

    #menu {
      position: fixed;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.8);
      padding: 20px;
      border-radius: 8px;
      z-index: 100;
      min-width: 200px;
      max-width: 320px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    }

    #menu h3 {
      color: #fff;
      margin-bottom: 15px;
      font-size: 16px;
      text-align: center;
    }

    #description {
      color: #f0ad4e;
      font-size: 13px;
      line-height: 1.6;
      margin-bottom: 15px;
      padding: 12px;
      background: rgba(240, 173, 78, 0.1);
      border-left: 3px solid #f0ad4e;
      border-radius: 4px;
    }

    .menu-buttons {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    button {
      padding: 10px 15px;
      background: #2a9d8f;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    button:hover {
      background: #21867a;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    button.active {
      background: #e76f51;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    #imageInfo {
      color: #aaa;
      font-size: 12px;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #444;
      text-align: center;
    }
  </style>
</head>

<body>
  <div id="menu">
    <h3>ğŸ•µğŸ» æ¡ˆç™¼ç¾å ´èº²è²“è²“ ğŸˆ</h3>
    <div id="description">
      æ³¨æ„ï¼ï¼ä½ çš„è²“åœ¨å®¶è£¡æ—è›‹äº†ï¼ï¼<br>
      ä½†æ˜¯ç‹¡çŒ¾çš„ç‰ ï¼Œå·§å¦™åœ°åˆ©ç”¨è‡ªå·±çš„èŠ±è‰²ï¼Œ<br>
      å°‡è‡ªå·±å’Œå®¶è£¡çš„å£ç´™èç‚ºä¸€é«”äº†ï¼ï¼<br>
      åªæœ‰ç•¶ä¸»äººä½¿ç”¨è£¸è¦–3Dèƒ½åŠ›æ™‚ï¼Œ<br>
      æ‰æœ‰è¾¦æ³•æŠ“åˆ°é€™éš»æ—è›‹é¬¼ï¼ï¼ï¼
    </div>
    <div class="menu-buttons">
      <button data-image="data/final_gray.png">å ´æ™¯ä¸€</button>
      <button data-image="data/final_leopard.png">å ´æ™¯äºŒ</button>
      <button data-image="data/final_orange.png">å ´æ™¯ä¸‰</button>
    </div>
  </div>

  <canvas id="glslCanvas" data-fragment-url="shaders/magiceye.frag" width="800" height="600"></canvas>

  <script>
    var canvas = document.getElementById("glslCanvas");
    var sandbox = new GlslCanvas(canvas);
    var currentImage = "data/final_gray.png";
    var currentImageName = "ç°è‰²åœ–";

    // è¨­å®šåˆå§‹ç´‹ç†
    sandbox.setUniform("u_resolution", canvas.width, canvas.height);
    sandbox.loadTexture("u_texture", currentImage);

    // è‡ªé©æ‡‰è¦–çª—å¤§å°
    window.addEventListener('resize', function() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      sandbox.setUniform("u_resolution", canvas.width, canvas.height);
    });

    // åˆå§‹åŒ–æŒ‰éˆ•å’Œäº‹ä»¶
    const buttons = document.querySelectorAll('button');
    buttons[0].classList.add('active');

    buttons.forEach((button, index) => {
      button.addEventListener('click', function() {
        const imagePath = this.getAttribute('data-image');
        const imageName = this.textContent;
        
        // æ›´æ–°æŒ‰éˆ•æ¨£å¼
        buttons.forEach(btn => btn.classList.remove('active'));
        this.classList.add('active');

        // è¼‰å…¥æ–°åœ–ç‰‡
        currentImage = imagePath;
        currentImageName = imageName;
        sandbox.loadTexture("u_texture", imagePath);
        
        // æ›´æ–°é¡¯ç¤ºçš„åœ–ç‰‡è³‡è¨Š
        document.getElementById('imageInfo').textContent = 'ç›®å‰: ' + imageName;
      });
    });

    // è¨­å®š canvas å¡«æ»¿æ•´å€‹è¦–çª—
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      sandbox.setUniform("u_resolution", canvas.width, canvas.height);
    }

    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);
  </script>

</body>

</html>
